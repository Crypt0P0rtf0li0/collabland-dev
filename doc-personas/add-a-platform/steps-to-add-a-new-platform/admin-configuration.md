---
sidebar_position: 7
sidebar_label: Admin Configuration
sidebar_class_name: nav-normal-page
id: admin-configuration
---

# Admin Configuration

- [Configuration Overview](#configuration-overview)
- [Command Center](#command-center)
- [Admin Command Center Login](#admin-command-center-login)
  - [Authentication](#authentication)
    - [Oauth2 Login](#oauth2-login)
    - [AE Token](#ae-token)
- [Debugging](#debugging)

---

## Configuration Overview

<aside>
📕 A platform has communities. A community has admins and members. Admins are able to approve/remove members to/from the community and set up community roles (`Level-1`, `Level-2` for example). For example, role `Level-1` members have access to `level-1 channel` . Roles are signed by admins.

</aside>

To token gate communities on your platform, the community admin will need to set up token permission rule(s). Based on the nature of your application, these rules can apply membership actions(add/invite users) or apply certain roles actions.

For example, to join server “[Collab.Land](http://Collab.Land) Friends”, you will need to have at least one [Collab.Land Membership NFT](https://opensea.io/collection/collab-land-genesis-membership-nft).

By specifying the contract address, the type, the amount, and which action (approve membership) this rule link to. Once users connected their wallets, [Collab.Land](http://Collab.Land) API server would check their holding based on this rule and apply the results.

## Command Center

Instead of having your platform implement such bot interfaces, admins could simply log in to [Collab.Land](http://Collab.Land) Command Center site to set up token permission rules with our existing functions and UI.

![CC login](./images/cc-login.png)

Command Center currently supports:

- [ ] add chain list

Your platform will need to provide APIs for [Collab.Land](http://Collab.Land) (your extension) to:

- check if the given user is an admin
- get a list of communities the user moderate
- read all roles (name, id) from a community

## Admin Command Center Login

Upon admins log in to Command Center, [Collab.Land](http://Collab.Land) will need to authenticate if the user if coming from a trusted application and if they are admins.

### Authentication

There are two main solutions:

1. Oauth2 Login
2. AE token generated by [Collab.Land](http://Collab.Land) (server-to-sever)

#### Oauth2 Login

If your app already has Oauth2 login , we can add a login entry to Command Center for your platform.

![CCconfig](./images/cc-config.png)

To ensure the state won’t get changed outside of [Collab.Land](http://Collab.Land) websites, [Collab.Land](http://Collab.Land) has an Oauth2 login component to encrypt the original state (`components/oauth2-logins/src/services/oauth2-client.service.ts`). Collab.Land will verify the user on your side with the granted access token. When a user finishes the login flow and comes back to a Collab.Land site, we will decode and verify the encrypted state in the URL.

It also allows you to configure client id, secret, authorize URL, token URL, etc. It is also loosely designed so that you can also customize the request header, state params, response, etc.

Example: `**components/oauth2-logins/src/controllers/reddit-login.controller.ts**`

```jsx
const client = new OAuth2ClientService(
  {
    provider: 'reddit',
    clientId: communityConfig.clientId,
    clientSecret: communityConfig.clientSecret,
    authorizeUrl: 'https://www.reddit.com/api/v1/authorize',
    tokenUrl: 'https://www.reddit.com/api/v1/access_token',
    usesClientAuth: true,
    stateParams: ['flow', 'subreddit'],
    headersToRequestToken: {
      'User-Agent': `Mozilla/5.0 ${
        communityConfig.platformAppName ?? 'CollabLand'
      } by ${communityConfig.adminName ?? '/u/MimosaN71'}`,
    },
    getUserInfo: (token, urlState) =>
      this.getUserInfo(token.access_token, urlState),
    buildResponse: (
      userProfile: Partial<UserRecord>,
      originalState,
      _,
      token?: AccessTokenResponse
    ) =>
      admin
        ? this.buildAdminLoginResponse(userProfile, originalState, token)
        : this.buildResponse(userProfile, originalState),
  },
  this.jwt,
  this.kms
);
```

The login will hit an endpoint `/my-platform/authenticate` to get an access token and build user profile. Endpoint `/<my-platform>`.

You can find more examples under `components/oauth2-logins/src/controllers`.

#### AE Token

If your app does not support Oauth2 login yet, you can generate an AE token and redirect admins to Command Center with the token.

Your bot will need provide some kind of UI for admins that would hit [Collab.Land](http://Collab.Land) endpoint to generate an AE token, the redirect to Command Center straightly from Collab.Land API server along with the AE token.

## Debugging

Local server with debugging string. You might also need to build a MVP frontend to check your endpoints.
